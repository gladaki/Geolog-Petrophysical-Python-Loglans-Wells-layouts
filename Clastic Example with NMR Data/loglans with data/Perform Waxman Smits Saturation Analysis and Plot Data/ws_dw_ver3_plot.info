# spec : 
LANGUAGE = PYTHON
DESCRIPTION_DETAIL = "\#\#\# Introduction\:\nWe have written a new python loglan program for Geolog. The purpose of this program is to begin implementing python in our loglans. We are using the new geolog.getrow and geolog.putrow for this code.  This method behaves very similar to the normal Geolog loglans in that this method is frame by frame. \n\n\n\#\#\# Load data from geolog\nwhile geolog.getrow()\:\n\n\n    \# Store data into geolog\n    geolog.putrow()\n\n\n\nThe alternative geolog.gettable() and geolog.puttable have been tried, but with no success with this program.  We are still working on this implementation which does have benefits in loading all the data into a pandas dataFrame, making interactive plots along the process and entering parameters interactively as a part of the process. \n\n\#\#\# Documentation to ws_dw.pysh Program\nThe objective of this document is to explain the log analysis process used to integrate the NMR with conventional well log data acquired on our example well. This method provides for a very for a comprehensive, integrated log analysis model in shaley sands. The results are water saturations from George Coates’ MRIAN Dual-Water1 and Waxman-Smits2. The second paper below employs 90% of the techniques that I had developed while at Western Atlas, but was published 5 years later by Ostroff, Shorey and Georgi. \n\nMuch of the code came directly from Coates’ MRIAN analysis1 paper. Coates’ Dual-Water effective Computed Bulk Volume Water (CBVWE) that is computed from the process can be directly compared to the NMR Bulk Volume Irreducible (MBVI) to accurately predict intervals capable of producing water-free hydrocarbons. In the example below in the second to the last track, the free water is shown as a cyan fill. From our analysis all but the bottom of this well should initially produce water-free hydrocarbons. We make use of both the Dual-water model as proposed by Coates (SPWLA, 1994) and the Waxman-Smits equation to compute our saturations.\n\n1.  Coates, G.R., Gardner, J.S., and Miller, D.L., 1994, Applying pulse-echo NMR to shaly sand formation evaluation, paper B, 35th Annual SPWLA Logging Symposium Transac- tions, 22 p. \n2.  Ostroff, G.M., Shorey, D.S., and Georgi, D.T., 1999, Integration of NMR and conven- tional log data for improved petrophysical evaluation of shaly sands, 40th Annual SPWLA Logging Symposium Transactions, 14\n\nNMR Data\nThe primary data used from the NMR technology are\:\n\nNMR Effective (MPHI) Porosity\nNMR Capillary Bound Water\nThe NMR tools of today also provide NMR Total Porosity and Clay Bound Water\nT2 Distributions \nS/V ratio\nk(T2) \n\n\nFrom the raw NMR data, we can determine (using MRIL mnemonics)\:\n• A mineralogically independent effective porosity (MPHI)\n• T2 bin distribution (P1 through P8…)\n• Pore size distribution (select Echoes)\n• Bulk volume irreducible (MBVI)\n• Bulk volume movable (MBVM or MFFI)\n• Permeability (MPERM)\n• Viscosity of pore fluids (Diffusion)\n\n\nThe NMR data can be depth shifted and presented juxtapose the conventional logs for a meaningful presentation as shown above. While at Aramco we QC’d our MultiMin analysis by making this direct comparison (Cheshire, 1999, personal communications).\n\nDual-Water and Waxman-Smits Analysis using Python code in Geolog\nOne of the most successful ways of interpreting NMR data for reservoir quality and hydrocarbon pore volumes is to combine the NMR data with conventional logs. We directly employ the NMR data with the open hole logs to calculate a Bulk Volume Water to compare to the NMR Bulk Volume Irreducible (BVI) to assess those intervals that are above the transition zone and capable of producing water-free hydrocarbons. The key to the analysis is that the NMR effective porosity (MPHI) does not see the Clay Bound Water (CBW). We can obtain a total porosity (PHIT) from the density or neutron-density cross plot porosity (or sonic in bad hole) and use the difference of PHIT - MPHI to provide an initial estimate of CBW. \n\n    CBW  \=  PHIT - MPHI\n\nThe above equation can be visualized in the following diagram of the bulk volume model\:\n\n \nIn shaley sands, the neutron-density cross plot porosity appears work the best for this analysis. \n\nThe bound water saturation (Swb) is calculated\:\n\n\n    Swb \= (PHIT - MPHI) / PHIT\n  \n\n    Swb \= CBW  /  PHIT\n\n\nCoates’ Dual-water Analysis from MRIAN\nThis analysis utilizes the principles proposed by Coates, et al., (SPWLA, 1994)1. He uses the above described Swb with a slightly different version of the Dual-Water model to calculate the total water saturation (SwT)\:\n\n\n        Ct \= 1/a * PHIT**m0  * SwT n [Cw + Swb/ SwT (Ccw-Cw)]\n\nwhere the clay water conductivity (Ccw) is a function of temperature (T, in Deg. F.) and defined as\:\n\n        Ccw \= 0.000216*(T + 504.4)*(T-16.7)\n\nwhen Rw, the formation water resistivity (Ohmm), is less than 0.16 ohmm (Clavier, et al., 1977). The free water conductivity (Cw) is defined as\:\n\n        Cw \= (T + 6.77) / (Rw *(Rwt+6.77))\n\nwhere Rwt is the formation water resistivity temperature (Deg. F.).  \n\n        Ct \= 1 / Rt\n\nRt is the true formation resistivity (Ohmm).\n\nOverly optimistic hydrocarbon saturations can occur in shales if a constant cementation exponent (m) and saturation exponent (n) are used in the calculation of SwT. M and n’s measured on conventional core are dominantly from the cleaner portion of the reservoir rock. Studies have shown that with increased tortuosity, as is the case with shales, the Formation Factor (FF) increases too.  An increase in FF results in an increase in m. To compensate for the increase in tortuosity in the shales, Coates and Howard (SPWLA, 1992)3 proposed a combined m/n (wq) term that varied with the irreducible water saturation\:\n\n        wq \= 0.4 * Swir + 1.65\n\nwhere the irreducible water saturation (Swir) is defined as\:\n\n        Swir \= MBVI / MPHI\n\nThis automatically calculated variable w corrects the electrical properties. Additionally, Coates calculates apparent w’s for the 100% water saturated condition (ww) and at Swir (wi). W is constrained to vary within these boundaries. The result is that SwT is bound between 1.0 and Swir. The SwT is converted to a bulk volume water total (CBVWT)\:\n\n\n        CBVWT \= SwT * PHIT\n\n\nand the Dual-Water computed bulk volume water effective is calculated as\:\n\n\n        CBVWE \= CBVWT - CBW \n\n\nThis is a key point!  If we are to compare the bulk volume water to MBVI, then we must be cognoscente of the fact that MBVI does not include the clay bound water (CBW).  For example, if an effective bulk volume water is calculated from another log analysis program; then the effective bulk volume water might not compare directly to MBVI. The reason is that the effective porosity might still contain some of the clay bound water. If the effective porosity is higher than MPHI, then it does contain some of the clay bound water. The difference between the effective porosity and MPHI must be subtracted from the effective bulk volume water for a valid comparison to MBVI in the effective porosity system. \n\n\n3   Coates, G.R., and Howard, A.D., 1992, Core data and the MRIL show a new approach to formation factor, SCA-9207, in 6th annual technical conference preprints (33rd Annual SPWLA Logging Symposium Transactions, v. 3)\: Society of Core Analysts, Society of Professional Well Log Analysts Chapter-at-Large, 14 p. \n\n\n\nThe CBVWE can be used directly in the plot deck to illustrate hydrocarbons, free water and MBVI. We generally achieve this by plotting and filling from MPHI to CBVWE as EPIPLT red for hydrocarbons, CBVWE to MBVI as cyan for free water and MBVI to the edge of the track as volatiles for capillary bound water. Wherever the CBVWE lies up against the MBVI, then the zone is above the transition zone and water-free production of hydrocarbons can be expected. When the potential for free, movable water exists, CBVWE will not lie against or near MBVI and cyan fill will be apparent. \n\n**** Analysis Process\:\n\nParameter selection\nThe Rw, temperatures and gradient are selected as usual. Rw can come from the client, Pickett plot or Rwa’s. In this instance we are using a Pickett Plot to determine Rw\:\n\n\nWhere the Pickett plot suggests an Rw of 0.025 and an m of 2. Keep in mind, this is the Rw at formation temperature. \n\nExperience has shown that this type of analysis works best with the neutron-density cross plot porosity for PHIT. The matrix density and fluid density are required. \n\nThe cross plot of the NPHI vs. MPHI data is used to select the NPHI and MPHI of the shale point. \n\nThe CBW option should be set to ASIS for the first pass. It is at this point that the first pass of the analysis can be made.\n\nAfter the first pass then the CBW vs. Vshale cross plot should be evaluated to observe for any abnormal trend due to MPHI suppression usually due to gas. If there is a deviation from the normal trend, then the CBW Option of VSH should be used. In this instance the program will want the y intercept in the cross plot where Vsh (or Swb) are at 1. In this instance CBW_INT is 0.2 using the strong linear trend shown below. \n\nCoates and Miller did an excellent job of modeling a variable wq to account for changes in the electrical properties over the formation interval. For the Waxman-Smits Bulk Volume Water (BVWE) calculation, a cross plot of the apparent m* called MNA vs. Vsh is made to select the proper slope and clean m* trend in the data (see below). \n\n\nMNA is calculated using the following equation\:\n\n\n        mna \= math.log10(rwg*1/(rt*(1+rwg*b*qv)))/math.log10(phit)\n\n\nMNA is the apparent m*, and MNA is only valid in wet intervals forming a wet trend of m* vs. Vsh as shown above. There are three sloped lines found on the above cross plot. The blue line has a slope of 1, green line 2 and red line 3. From our example data the slope of the wet portion of apparent m* (MSLOPE) is approximately 2. The y intercept where Vsh \= 0 is the Archie m since this is clean rock. As Vsh and Swb increase, then our m* increases along the MSLOPE line that we have chosen as shown in the code below\: \n\n\n    \# Archie m is used as y intercept where with no Swb m and m* are equal\n    if mstar_opt \=\= 'SWB'\:\n        mnc \= mslope * swb + m\n    \n    elif mstar_opt \=\= 'VSH'\:\n        mnc \= mslope * vsh + m\n        \n    mstar \= mnc\n\n\nThis results in a variable m* and we are using a constant n* of 2. \n\nThe second pass of the analysis with the final parameters should provide reliable results. Typically, we rely on the Coates’ Dual-Water Bulk Volume Water (CBVWE) in the effective porosity system as our primary estimate of the BVWe. The Waxman-Smits BVWE can be plotted alongside the Dual-Water CBVWE to check the comparison. We will normally find a very close agreement between the two results. If not, slight adjustment of the m* slope and intercept might be necessary. \n\n\nSpecial Case - Suppression of MPHI resulting in excessive Swb\nGas, paramagnetic effects, gypsum and other situations can yield too low of an MPHI. Our experience to date has shown that the Hydrogen Index of the hydrocarbons is usually the problem. In these situations, the suppressed MPHI would indicate excessive CBW in comparing the suppressed MPHI to PHIT and Swb would be too high. To examine for the occurrence of this situation, it is always advisable to cross plot other clay indicators vs. Swb. We will include a python means to calculate a median filtered Swb from a number of clay indicators in future versions.  \n\nOne of the best clay indicators that we have found is derived from the Neutron vs. MPHI cross plot. This crossplot is particularly good for shaley sands containing gas where we can still obtain a representative clay volume. In contrast, a neutron-density crossplot can have a gaseous shaley sand with data points lying on the clean sand line. \n\nThe Neutron-MPHI cross plot avoids the problem of gas. Gas will move the samples along the iso-clay line, and the clay component vector appears to be the major driving force for this plot\:\n\nThe above plot should not be used for porosity.  All that is required for our inputs is the MPHI and the Neutron of the clay. \n\nWe want to determine Shale volume. Vclay and Vshale are terms repeatedly misused by industry. Vclay and Vshale are not synonymous. A typical shale falling near the shale point will contain far less than 100% clay. Most shales have a maximum clay content of only 60-70%. In our analysis we are selecting the shale point and not some imaginary clay point.\n\nIn general correlations of Vshale to Swb are normally quite good. Thomas-Steiber (1975) introduced a Vshale vs. porosity cross plot used to distinguishing dispersed from laminated and structural shales. \n\nAgain, to examine for the occurrence of an excessive Swb, it is always advisable to cross plot the shale indicator vs. Swb. The normal cross plot trend between Swb and clay volume, calculated from the above described neutron (NPHI) - MPHI cross plot, is generally linear with a very high correlation coefficient. This has been found to be especially true if the neutron-density crossplot porosity is used as the total porosity. \n\nA problem can occur with calculating Vshale from the NPHI-MPHI crossplot if the suppressed MPHI is a result of an improper Wait Times for the NMR. In this instance, MPHI would be too low for the corresponding NPHI. The result is that the calculated Vshale would be too high. We recommend cross plotting other shale indicators (GR, SP, MEDIAN FILTERED Swb, etc.) vs. Swb for all jobs. The GR vs. Swb might verify a clean sand. If this is the case, then the reservoir should be zoned for the processing. The proper Swb option should be employed to lower the Swb accordingly.\n\nIf MPHI is suppressed (usually due to the Hydrogen Index effect of the hydrocarbons), then Swb will be too large and a departure from the normal trend is observed. If the suppression is due to hydrocarbons, then this condition will mainly be observed in the low Vcl region of the plot where hydrocarbons are present.\n\n"
MARKDOWN = Yes
MODE: ARG:     VAR:     TYPE:     REPEAT: DEFAULT:  VALIDATION: LOCATION: UNIT: VISIBLE: TAB_LABEL: COMMENT=
#==== ====     ====     =====     ======= ========  =========== ========= ===== ======== ========== ========                                                        
INPUT FILE_IN  file_in  FILE      ""      ""        ""          ""        ""    TRUE     ""         "Input table (pipe)."
INPUT SET_IN   set_in   REAL      ""      WS        ""          PARAMETER ""    TRUE     ""         ""
INPUT SET_OUT  set_out  REAL      ""      WS        ""          PARAMETER ""    TRUE     ""         ""
INPUT RHO_F    rho_f    NAME_REAL ""      ""        ""          CONSTANT  G/C3  TRUE     ""         "Density of Fluid"
INPUT RHO_M    rho_m    NAME_REAL ""      ""        ""          CONSTANT  G/C3  TRUE     ""         "Density of Matrix"
INPUT RHO_SH   rho_sh   NAME_REAL ""      ""        ""          CONSTANT  G/C3  TRUE     ""         "Density of Shale"
INPUT NPHI_SH  nphi_sh  NAME_REAL ""      ""        ""          CONSTANT  V/V   TRUE     ""         "Neutron Shale"
INPUT DEPTH    depth    NAME_REAL ""      DEPTH     ""          LOG       FEET  TRUE     ""         "Downhole depth"
INPUT GR       gr       NAME_REAL ""      WIRE.GR   ""          LOG       GAPI  TRUE     ""         "Gamma Ray"
INPUT CALI     cali     NAME_REAL ""      WIRE.CALI ""          LOG       IN    TRUE     ""         Caliper
INPUT SP       sp       NAME_REAL ""      WIRE.SP   ""          LOG       MV    TRUE     ""         "Spontaneous Potential"
INPUT RT       rt       NAME_REAL ""      WIRE.RT   ""          LOG       OHMM  TRUE     ""         "True Resistivity"
INPUT ILM      ilm      NAME_REAL ""      WIRE.ILM  ""          LOG       OHMM  TRUE     ""         "Medium Induction Standard Processed Resistivity"
INPUT RMLL     rmll     NAME_REAL ""      WIRE.RMLL ""          LOG       OHMM  TRUE     ""         "Rxo Device"
INPUT PHIX     phix     NAME_REAL ""      WIRE.PHIX ""          LOG       V/V   TRUE     ""         "Crossplot Porosity"
INPUT RHOB     rhob     NAME_REAL ""      WIRE.RHOB ""          LOG       G/C3  TRUE     ""         "Bulk Density"
INPUT NPHI     nphi     NAME_REAL ""      WIRE.NPHI ""          LOG       V/V   TRUE     ""         "Neutron porosity"
INPUT DT       dt       NAME_REAL ""      WIRE.DT   ""          LOG       US/F  TRUE     ""         "Delta Time"
INPUT MPHI     mphi     NAME_REAL ""      WIRE.MPHI ""          LOG       V/V   TRUE     ""         "MRI Effective Porosity"
INPUT MBVI     mbvi     NAME_REAL ""      WIRE.MBVI ""          LOG       V/V   TRUE     ""         "MRIL Bulk volume irreducible"
INPUT PHIT     phit     NAME_REAL ""      PHIT      ""          LOG       V/V   TRUE     ""         "Total Porosity"
INPUT PHIE     phie     NAME_REAL ""      PHIE      ""          LOG       V/V   TRUE     ""         "Effective Porosity"
INPUT PHI      phi      NAME_REAL ""      PHI       ""          LOG       V/V   TRUE     ""         "Porosity from Shale Triange used just in Shale Calculations"
INPUT PHI_ND   phi_nd   NAME_REAL ""      PHI_ND    ""          LOG       V/V   TRUE     ""         "Porosity from NEUTDEN xplot  used just in Shale Calculations"
INPUT POR_DEN  por_den  NAME_REAL ""      POR_DEN   ""          LOG       V/V   TRUE     ""         "Density Porosity"
INPUT VSH_NEUT vsh_neut NAME_REAL ""      VSH_NEUT  ""          LOG       V/V   TRUE     ""         "Volume of Shale Neut-MPHI"
INPUT VSH_ND   vsh_nd   NAME_REAL ""      VSH_ND    ""          LOG       V/V   TRUE     ""         "Volume of Shale Neutron-Density"
INPUT VSH_GR   vsh_gr   NAME_REAL ""      VSH_GR    ""          LOG       V/V   TRUE     ""         "Volume of Shale GR"
INPUT VSH      vsh      NAME_REAL ""      VSH       ""          LOG       V/V   TRUE     ""         "Volume of Shale used in Analysis"
INPUT SWB      swb      NAME_REAL ""      SWB       ""          LOG       V/V   TRUE     ""         "Bound Water Saturation"
INPUT CBW      cbw      NAME_REAL ""      CBW       ""          LOG       V/V   TRUE     ""         "Clay-Bound Water"
INPUT QV       qv       NAME_REAL ""      QV        ""          LOG       M/C3  TRUE     ""         "CEC per unit pore volume"
INPUT MNA      mna      NAME_REAL ""      MNA       ""          LOG       ""    TRUE     ""         "m* apparent,  valid in wet intervals for m* trend"
INPUT MSTAR    mstar    NAME_REAL ""      MSTAR     ""          LOG       ""    TRUE     ""         "m* used in Waxman-Smits"
INPUT SWT_I    swt_i    NAME_REAL ""      SWT_I     ""          LOG       V/V   TRUE     ""         "Waxman-Smits Water Saturation - Iterative approach"
INPUT SWT_C    swt_c    NAME_REAL ""      SWT_C     ""          LOG       V/V   TRUE     ""         "Waxman-Smits Water Saturation - Crain's approach"
INPUT BVWT     bvwt     NAME_REAL ""      BVWT      ""          LOG       V/V   TRUE     ""         "BVW Total System"
INPUT BVWE     bvwe     NAME_REAL ""      BVWE      ""          LOG       V/V   TRUE     ""         "BVW Effective System"
INPUT SWDW     swdw     NAME_REAL ""      SWDW      ""          LOG       V/V   TRUE     ""         "Dual Water Swt in Total System from Coates MRIAN analysis"
INPUT CBVWT    cbvwt    NAME_REAL ""      CBVWT     ""          LOG       V/V   TRUE     ""         "Dual Water BVW in Total System from Coates MRIAN analysis"
INPUT CBVWE    cbvwe    NAME_REAL ""      CBVWE     ""          LOG       V/V   TRUE     ""         "Dual Water BVW in Effective System from Coates MRIAN analysis"
INPUT WI       wi       NAME_REAL ""      WI        ""          LOG       ""    TRUE     ""         "W at Swir"
INPUT WW       ww       NAME_REAL ""      WW        ""          LOG       ""    TRUE     ""         "W at 100% Sw"
INPUT WQ       wq       NAME_REAL ""      WQ        ""          LOG       ""    TRUE     ""         "W for Dual Water"
